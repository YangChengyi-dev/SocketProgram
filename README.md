# Socket 聊天室项目说明

## 概述
- 基于 TCP 的多人聊天室，支持广播、定向私聊、在线列表、昵称更改、帮助提示
- 支持图片点对点传输的握手机制：请求→接受并指定保存路径→分片发送→落盘
- 仅包含 Socket 聊天室功能，不涉及其他服务

## 目录结构
- tcpSerSock.py：TCP 聊天服务器
- tcpCliSock1.py / tcpCliSock2.py / tcpCliSock3.py：TCP 聊天客户端示例

## 环境依赖
- 纯标准库，无第三方依赖（socket、threading、sys、os、base64）

## 快速开始
1) 启动服务器
```bash
python tcpSerSock.py
```
2) 启动客户端（任选其一或多个）
```bash
python tcpCliSock1.py
```

## 客户端命令
- 广播：直接输入消息
- 私聊：@对方昵称:消息内容
- 查看在线：/list
- 修改昵称：/nick 新昵称
- 帮助：/help
- 退出：quit 或 /quit
- 发起图片请求：/img @对方昵称 文件路径
  - 示例：/img @Alice d:\pictures\cat.png
- 接受图片并指定保存路径：/accept 发送者 文件名 保存路径
  - 示例：/accept Alice cat.png D:\SaveDir\
  - 保存路径可以是目录（将以原文件名保存）或完整文件路径（自定义文件名）
- 拒绝接收图片：/reject 发送者 文件名

## 交互规则
- 私聊格式：@昵称:内容
- 昵称唯一性：服务器校验，重复昵称会被拒绝；更名广播提示
- 图片传输：
  - 发送方执行 /img 后仅发送请求，不立即传输数据
  - 接收方执行 /accept 后，发送方开始分片发送；/reject 则取消
  - 接收端只在已接受的情况下重组分片并落盘，不会打印任何 Base64 数据
  - 目标保存路径若存在同名文件，将自动在文件名后追加序号避免覆盖

## 服务器端操作
- 控制台输入任意文本可广播到所有客户端
- 输入 quit 关闭所有连接并退出

## 常见问题
- 未知命令：请使用 /help 查看命令列表与用法
- 更改昵称失败：/nick 新昵称；若缺少参数会收到“用法：/nick 新昵称”，重复昵称将被拒绝
- 查看在线列表无反馈：确保客户端接收线程在运行（连接成功后自动启动）
- 发送图片失败：确认文件路径存在且可读；Windows 路径可使用双引号包裹避免空格问题

## 注意事项
- 局域网通信需开放 21567（TCP）端口
- 图片通过 Base64 文本分片传输，适合中小图片；大文件会产生较多分片
- 如需更高效与可靠，可后续升级为二进制协议、断点续传、服务端持久化等机制

代码托管在https://github.com/YangChengyi-dev/SocketProgram